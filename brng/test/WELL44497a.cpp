#include "../../test_simple/test_simple_include.hpp"
#include "test_tools_rng.hpp"

extern "C" {
#include "external/WELL44497a.h"
}

#include "distribution/uniform_distribution.hpp"
#include <WELL44497a.hpp>

#include <chrono>
#include <cstdint>
#include <iostream>
#include <numeric>
#include <random>

auto main() -> int {
    {
        std::seed_seq seq{1, 2, 3, 4, 5};
        adhoc::canonical<adhoc::WELL44497a<std::uint32_t>> rng(seq);

        std::array<unsigned int, 1391> seed{
            1731050605, 3533173809, 1635178926, 2178890313, 2894575995,
            3124391466, 3738277652, 3369107531, 3702653374, 1628297818,
            666780699,  2345228673, 1444765150, 1149389068, 100429294,
            2568594623, 289411625,  3009169632, 2681874776, 645788791,
            1659097943, 711518962,  1841958966, 2560321849, 4018621239,
            2622687284, 802932237,  1210692964, 2311676066, 1834607898,
            2397828906, 3188864285, 1606958611, 2377076485, 726329307,
            3116428294, 351634367,  1540237212, 1898188591, 1441434233,
            1650686163, 2808697517, 1526401228, 3841646575, 2782431302,
            1942452942, 117139669,  2078113997, 2480883963, 4088802449,
            490392743,  4289430908, 3436894835, 2913830201, 1175825511,
            1839195753, 3862134170, 3598299376, 3186402298, 2151732238,
            28877909,   413296017,  1357606049, 1608978541, 1629995200,
            3381609484, 3042669884, 1337921583, 2914704111, 2552181723,
            2323978655, 1041962064, 2835367978, 1907670416, 771780247,
            1164482146, 1856324493, 2392241397, 4007302017, 3121506243,
            4039906553, 2102733673, 3466512423, 1150427901, 1772497333,
            2610199515, 652242943,  1925486205, 3812478925, 310917519,
            2566171162, 3159401392, 2076243968, 1822078096, 2896536382,
            3544652115, 112179362,  3209308484, 3204357729, 3368591648,
            2099757215, 357208190,  1804766299, 1869878302, 2878373135,
            1452245531, 1667194216, 1754191207, 2078920249, 2902071523,
            3788421607, 3301228061, 3251588336, 4026070239, 3731964486,
            4282542823, 2078402503, 892369514,  138684051,  328931351,
            3642218556, 1600678893, 3675349392, 317963599,  1877604282,
            4118311557, 1842597043, 352337378,  3468375351, 2760931955,
            480189234,  629876981,  1173949679, 578254660,  3739963018,
            2035871522, 167229310,  643953894,  1735164747, 401884759,
            3209331017, 3415677070, 888337924,  29133819,   1656883727,
            3688563278, 293360492,  680157685,  114074771,  1563931529,
            2702855967, 1484734400, 1835264344, 2146797149, 3434874682,
            1514852568, 2141217107, 1862739884, 3293441871, 2654977193,
            2030141316, 2092350468, 1234772027, 2815260033, 2741021498,
            891238295,  2406706527, 2275350431, 2549398809, 1308590944,
            2448580723, 594612214,  2716131467, 1919044684, 1515026588,
            436874581,  3595885080, 4023517623, 1818382577, 3655907623,
            1100272780, 1606652363, 2884521998, 1261801810, 2819970706,
            672916415,  2659280779, 2855441401, 658845053,  2056499927,
            2971543003, 2263755159, 1541880491, 3946052953, 1377849732,
            96464377,   2957350628, 2433911994, 10934172,   3182824072,
            3850896007, 1477429254, 4210187815, 3236320078, 2594565912,
            3664368622, 1076743846, 1549682761, 2863736847, 4026952129,
            3306132771, 949343561,  992158732,  3950301692, 3726749497,
            1145059237, 3153977086, 2324004831, 2736254518, 143316905,
            2456297275, 703657531,  1029899338, 4034194833, 2665922325,
            1550166282, 339877774,  1595106882, 2249123705, 3018526814,
            3584511845, 175066284,  3886347859, 3126842755, 355910553,
            2981897745, 2500234115, 4199828800, 3380900451, 336359757,
            1251543637, 1813261268, 3296214349, 735252067,  33491477,
            4161273169, 3585689355, 3448553228, 2940867335, 364056496,
            3976481603, 2646244950, 57399154,   3398186312, 4180978129,
            886652864,  1335220808, 1852534947, 512179604,  2535572059,
            433090178,  1011039070, 715769987,  519118256,  2898312120,
            1042484522, 2292905326, 4122001369, 2001231092, 1397572328,
            1148034892, 615343038,  1941853001, 1358632691, 3173755013,
            976730201,  1936505183, 925494331,  614405646,  4284295187,
            4031003984, 351591056,  2969197919, 3791325262, 3144944986,
            1225361728, 4270958353, 200587965,  228700712,  1760164775,
            3807498808, 3494511736, 3675104248, 245455530,  1071736906,
            3648570739, 3929686867, 4252515961, 3855566342, 2091654901,
            4214811928, 3281242435, 4092923409, 3532365568, 493741160,
            3987169351, 2068042993, 373149881,  1296527509, 3765203261,
            1763320357, 1274262224, 2522007410, 4050734416, 436609943,
            1254181100, 853969043,  4213634786, 3670107208, 120507056,
            1188374665, 4041184946, 3619511663, 473263755,  2219791674,
            83356467,   818821687,  9716950,    4036380371, 774944463,
            3223422265, 3944688230, 2648827851, 1018246271, 2224759426,
            139665341,  2494812048, 1852830904, 3372327728, 3747798979,
            2031726202, 3620485171, 2963206506, 165898022,  3652900260,
            683788318,  3894101818, 3270170633, 4099915626, 3984677517,
            1834998777, 4201293649, 3790795338, 1306669527, 2094349242,
            2332461096, 2364288890, 2166159994, 3275501781, 2834807534,
            2817155379, 481538514,  2964633956, 3312255118, 1719485595,
            1855304605, 3688653535, 2940381093, 2426825613, 2877920186,
            2032084767, 2449097251, 2478484043, 2599160229, 173365659,
            3106786917, 3069657812, 1979915587, 3559537715, 2029022784,
            3520221110, 4199674567, 782732081,  1001593534, 2337402409,
            1513051250, 3897453083, 6464566,    885805036,  4225442214,
            83040259,   3277241903, 2040477227, 2265830158, 1828411007,
            4156520285, 4166787307, 804889022,  10097635,   1843409957,
            2532499501, 3097741759, 2801361672, 3863301845, 3373540061,
            2777567712, 2296209365, 2946695560, 3166740451, 2832544670,
            3343184506, 643192333,  2897195878, 3351448625, 1812828972,
            2620688035, 827473512,  347971982,  1838059978, 978980121,
            3479419984, 873137823,  2027606400, 1024332013, 2154663341,
            1276193667, 3931673651, 3212958023, 2115951335, 2533059623,
            224351306,  4070908212, 477632026,  3707326043, 1485986167,
            1183902625, 1762565613, 3115315134, 3833615383, 1157947666,
            1242367785, 2919281723, 858909896,  1148623040, 3946095474,
            2932250872, 330357617,  3044825250, 2409515691, 4191907748,
            33888106,   1484129622, 711581238,  744659032,  2808493405,
            3520333233, 2724901781, 2785663906, 1303452366, 3346399041,
            820006698,  3818753779, 3621270573, 2216110286, 2023119706,
            2908297758, 2802517225, 687541808,  2148320311, 2080527032,
            3937086990, 3098094583, 639598233,  1931166999, 3474774043,
            3646863015, 2538149866, 2446996259, 3021662225, 1500381529,
            665108020,  738270204,  1365160090, 601326290,  2010410659,
            73425845,   153782194,  4171826513, 1738307538, 3702342595,
            606590605,  1280098985, 3509186853, 837399191,  516807761,
            1267900377, 3929374091, 4285549402, 301700974,  4101244867,
            3653596861, 1419992907, 2984423470, 1519100266, 2291146465,
            2063276499, 4157915960, 1091109419, 2826799481, 3894659528,
            1649421470, 3707201747, 2894685956, 1191399064, 103394666,
            3310409067, 1274985472, 1544298579, 2726097668, 3297760061,
            2557347777, 1607880295, 658808017,  3988112833, 1323901034,
            2601227085, 2658707606, 3897300128, 1579155024, 205437127,
            4063810221, 2903506417, 709132808,  1026867858, 3728983865,
            1136983238, 3969093158, 1680673825, 4029913293, 3417197982,
            1717915006, 1807340439, 2117645244, 59802239,   1016805589,
            924163546,  3518435984, 1655922864, 503941626,  3955325851,
            3708367519, 2729691246, 2545960598, 990809785,  3454260478,
            20073122,   3360922308, 1776143589, 3539790077, 910414459,
            1814185886, 756476100,  1489218569, 3481236143, 2797126229,
            168205308,  855432835,  3178608932, 1825769774, 3848000526,
            3308802328, 990737625,  1146820202, 4191111851, 2524508758,
            3461885340, 1522115354, 3132721165, 4182449630, 3440909611,
            2277582248, 1572909818, 1981795876, 2227647923, 4162937141,
            400556563,  1546747633, 11649844,   3974538430, 767980218,
            1345533203, 3425997252, 3651640217, 2827226855, 349515727,
            519373460,  3691192798, 2271941827, 1859722964, 2266766183,
            3160925801, 2728385808, 1289449354, 3690190987, 1918817694,
            3970783030, 1829735325, 874410997,  574319284,  2578487298,
            3978328931, 2562548953, 3183798512, 2744474090, 3658874444,
            1039583615, 3096361247, 2516782997, 2137805049, 3541714346,
            1533646709, 331739600,  625115984,  1010808373, 545406966,
            1632471883, 2648914368, 4049401833, 388888363,  3126845631,
            467385117,  4277213151, 976509976,  88287035,   1550468288,
            62151676,   3094144906, 388302200,  3908337253, 3446911924,
            1703563951, 73180891,   3494548891, 1885368735, 2694374689,
            3985739638, 1711850222, 3164108617, 141614781,  737356141,
            520096749,  640423711,  127633626,  1888146066, 3362748542,
            1464894940, 3335881831, 1132246015, 314631318,  245840387,
            3928123105, 2971135127, 3039966382, 3047458732, 2847412901,
            51003687,   3170955783, 2360847635, 2908934274, 4012575964,
            610667908,  3918402694, 2280771127, 1334295295, 1068884898,
            2720982934, 2819633405, 2243975929, 2312467919, 1462347059,
            2230251498, 3617285451, 724197898,  2829644344, 3932199992,
            2498960609, 3286802043, 1842329498, 2361278281, 2880835780,
            246723635,  2349616261, 1841707112, 205099906,  1123038746,
            2011378717, 236136376,  4145298501, 1359090793, 1382175517,
            39610804,   3574616366, 1999323391, 3628551683, 626621031,
            1077833738, 1323879525, 4133776495, 719031586,  2643541321,
            1950556568, 1233168260, 1214614559, 2671173263, 1094712197,
            1806488250, 3325029762, 1131961064, 1663280603, 4225707340,
            17829946,   464286316,  3458582106, 1161608692, 370046946,
            3425438918, 3712859031, 2918745602, 2056560552, 628553610,
            2912904703, 3941995123, 1249479874, 1129678941, 590697052,
            1461491196, 2570323048, 2791105018, 1379253644, 1982663410,
            2577709279, 600197373,  1450203840, 3314259117, 3733968896,
            2723517042, 74886949,   4150538180, 436302489,  955644071,
            1889841416, 3142862133, 2851481530, 537641652,  2813321609,
            3165581553, 1643663883, 325184379,  1523166052, 545555096,
            3246944749, 1547726523, 924436153,  2906124042, 2106914666,
            1352356106, 3624202634, 3360038381, 1661440938, 1370343497,
            126334946,  1131823790, 433230716,  668578032,  3052783493,
            1718589157, 2816670088, 428814565,  307729354,  196586640,
            2427266945, 4033340584, 223911319,  2231529261, 3854447247,
            3776984113, 2107010930, 3119945886, 4127354097, 466662147,
            3772866929, 1887339186, 3363276267, 3602013744, 3821834533,
            2631123631, 815347047,  4278709544, 2136105414, 2073596877,
            1252553709, 2651037055, 412754634,  858899607,  3064824935,
            3976941041, 3676596037, 172207972,  2556645904, 258542708,
            2693846829, 2461765462, 131540626,  3447279930, 2691766852,
            1328242745, 3741621865, 908567446,  3522299295, 1914321652,
            3747826960, 526826808,  886312319,  3869882345, 700941717,
            3372675439, 3840394179, 889023457,  2241523587, 3058376002,
            3010672500, 1836014149, 1827412815, 3882750333, 3261326654,
            2599770945, 2761051218, 1008293649, 578700177,  2534139040,
            2605292531, 3835879557, 1004709923, 2766918477, 1610532523,
            3093707446, 1355842433, 2420622577, 2455466084, 4221009001,
            96615204,   4209732202, 3822728645, 3673485319, 3291291484,
            2704387489, 291841017,  380784576,  3390981104, 890231241,
            611696493,  2276838543, 1247807807, 2887131054, 2554754217,
            3515364758, 1854613545, 3703235359, 4116667133, 1457415125,
            3750696318, 3285098468, 2195348028, 620661078,  1257358217,
            3878953955, 1437519897, 2511695719, 925894885,  2240488057,
            3497277778, 2581660698, 1791169846, 2868077612, 204142581,
            3850141556, 1562271871, 3811473061, 2001242682, 262483279,
            3509367425, 2272850836, 2165289131, 3627548970, 2532790825,
            2937752494, 2605168792, 3177525963, 810034992,  2551645606,
            1777692024, 3982072553, 526574626,  2923736577, 1562941026,
            2314888728, 176736731,  198036801,  338079002,  1700632956,
            105064839,  3963816319, 4028125537, 2286791428, 3554206084,
            3300431510, 3503440627, 2381845342, 267705743,  3320914568,
            226870980,  3778902457, 3572342174, 3203502753, 47966268,
            3146857457, 2870001040, 40938947,   606095456,  3849741750,
            1053231247, 2370065996, 1252172642, 4188253003, 1428817224,
            16011527,   1686516951, 3734365480, 1679391871, 1154762292,
            819862330,  3511164848, 1615093388, 4075793880, 1940491668,
            626460988,  1923269291, 2007544720, 1762092751, 2824483325,
            1174319061, 398165856,  2003426309, 4269945868, 3344040475,
            4120804588, 463779145,  2886858127, 3577865564, 2357788612,
            3389526973, 846397747,  1328519576, 466342888,  402021057,
            383678083,  3002100023, 3339507421, 3505011838, 938692190,
            290018335,  3257557685, 221922104,  449669419,  2856866896,
            3765433753, 1104614262, 2259218911, 4090725642, 658386410,
            209009655,  3293734898, 1536068629, 1329837054, 1158079098,
            4249966048, 2937606505, 3995035024, 2696700679, 608986570,
            1024025641, 2239770416, 3671976168, 4138774155, 2662214793,
            3389144019, 3168682346, 1070242843, 3466254278, 3854487660,
            2664251584, 2198131154, 770224428,  2760457311, 971498061,
            2462816815, 1800004980, 1531928323, 2225818289, 3679538125,
            695507394,  705570707,  1571581619, 2595599304, 3095965968,
            2085679745, 4140517017, 2538667203, 2316599945, 3248539894,
            4242296285, 3052486163, 2224053936, 4175138690, 28210374,
            1088230460, 944322624,  2954227488, 2891998177, 4100375057,
            4085659774, 1591952336, 432950516,  41489764,   2301489961,
            4162666276, 4097117834, 3024500023, 1662724001, 1072121329,
            1278194945, 3681739254, 491732645,  6082277,    3941666594,
            104996493,  985584640,  2055008374, 3960816270, 1628710365,
            1833303188, 419861246,  3921220346, 260955112,  280546629,
            2608056859, 465412706,  193218168,  3519807571, 811642233,
            2252632457, 1819761086, 954429480,  2732888825, 1968606650,
            923871842,  875349135,  2842665788, 490610615,  2179039102,
            3091434145, 3179071477, 2325026349, 72059252,   1682398986,
            3530597970, 1557757115, 3341944497, 843004053,  1800539584,
            1232379123, 3098869445, 559944126,  4059005764, 2299324557,
            3740439360, 2503037305, 3859084968, 3870501022, 851717021,
            3646325233, 1086540218, 2294744688, 1033294604, 2214811304,
            2840436419, 1351488859, 1687208199, 3293726795, 2543344583,
            2589773084, 4232558202, 1522738805, 2256665786, 2531628051,
            2469371246, 4132648041, 2439739305, 4035369286, 2284042069,
            632735895,  1363893988, 1741452595, 1882337153, 4034375041,
            1494765608, 1497310872, 1291909620, 246036313,  2394593387,
            3576057356, 4069782806, 3828702815, 268965990,  972347385,
            4212244234, 4072968445, 948829748,  2371199510, 2804481785,
            341620108,  1535043422, 481485028,  477507745,  12521344,
            103263493,  1515317440, 4083852022, 131304777,  4205035643,
            3805725018, 2252085277, 3087814975, 2353692310, 3732871266,
            1315057734, 2162603924, 1335352985, 2604044130, 666359265,
            839985493,  30651119,   3156229293, 1961257038, 1936492875,
            3294767283, 2558652851, 314804118,  2173716335, 894156702,
            4102595915, 1586728487, 3572628730, 4000034795, 716243366,
            1925420548, 123099354,  3352258600, 3718315900, 3070356156,
            3919336297, 1145315062, 2768044787, 3353515859, 3022036772,
            3693467250, 1859299767, 1363661263, 282373362,  2124318480,
            1867785181, 203852386,  3121286660, 1399414761, 4141193342,
            3352053583, 1964850632, 480380761,  1286884969, 3236275209,
            20259493,   3451908014, 1166918904, 1965646295, 331088365,
            1049336021, 4247648533, 552564192,  4235418099, 2296009359,
            1267244504, 2722422447, 781396106,  241197009,  31857393,
            187360296,  996203042,  1533312332, 3576796463, 2068167301,
            4149558649, 65711463,   3760074086, 3762776123, 579311915,
            1163837632, 1609869394, 356934688,  3921049490, 171411809,
            3156798046, 2501652473, 1095983046, 2747063130, 1206941772,
            1708985409, 1214876344, 4144121679, 3922273166, 2736108692,
            1262306945, 2484562470, 2600371469, 3774190312, 759508372,
            2994490439, 639238028,  1110779513, 876584316,  1100501194,
            2336181478, 1137855109, 481323070,  4192258192, 85563546,
            358994098,  1257850979, 4018247022, 1581639646, 321267112,
            2867534450, 1995369056, 1827529786, 3989877709, 2639147594,
            601575257,  2223760073, 2109729244, 2551158874, 2019884713,
            200814645,  3647964971, 3290956090, 2998636491, 3231382093,
            3191193057, 511425109,  3913765375, 491477877,  3872205971,
            1837485159, 134498360,  619537341,  2102169211, 1636027548,
            4084163305, 737815933,  1479260580, 4210865245, 2262708006,
            3832616451, 804262256,  1955130840, 2395432302, 1077250629,
            2383891216, 1054134631, 2423900707, 4053042540, 3782541914,
            1710650393, 28772531,   2166912393, 3073855355, 1661638414,
            3875401758, 2007862591, 2306576373, 283340323,  3991168548,
            1773185769, 3015635435, 982464332,  2669776696, 1973057142,
            3001585776, 2872395063, 2601381910, 879600877,  3012461390,
            3505020607, 1951377703, 367570834,  1509185444, 3014177426,
            4005834693, 1799727976, 4070411616, 3281128759, 2601940523,
            2864340761, 1125662200, 2036484629, 856203249,  3409940348,
            657548757,  1165168535, 3209444860, 1420138342, 3593175929,
            1055828277, 2993422566, 1912604990, 2799410640, 592273282,
            3845641770, 2912870290, 1966890435, 494688786,  38073675,
            2045628276, 73649656,   2246649306, 1179253094, 594616890,
            974137016,  3042114544, 2890804026, 1476657938, 4212443894,
            3889318725, 2201731973, 3052884893, 4113840051, 2833203677,
            4273330908, 3198003002, 2016340735, 3006538210, 3661123370,
            834347324,  1992753753, 2336812400, 625022817,  2667514979,
            1633229887, 1642928568, 3554621240, 1889992271, 4262422528,
            1581249398, 3307304306, 644239551,  3455371545, 449049486,
            3280367654, 784472292,  480028933,  3192092233, 182461595,
            3629854338, 3124808952, 2439110779, 3860128681, 3279138608,
            2925071280, 4285033060, 2760943171, 3755352358, 2359004066,
            2655672152};
        InitWELLRNG44497a(seed.data());

        std::cout.precision(std::numeric_limits<double>::max_digits10);
        for (std::size_t i = 0; i < 1000000; ++i) {
            auto val1 = rng();
            auto val2 = WELLRNG44497a();
            EXPECT_EQUAL(val1, val2);
            if (val1 != val2) {
                std::cout << val1 << std::endl;
                std::cout << val2 << std::endl;
            }
        }
    }

    {
        std::seed_seq seq{1, 2, 3, 4, 5};
        adhoc::WELL44497a<std::uint32_t> rng(seq);
        check_fwd_and_back(rng, 1000000);
        adhoc::WELL44497a<std::uint32_t> rng2(seq);
        EXPECT_EQUAL(rng, rng2);
    }

    {
        std::seed_seq seq{1, 2, 3, 4, 5};
        adhoc::WELL44497a<std::uint32_t> rng(seq);
        check_back_and_fwd(rng, 1000000);
        adhoc::WELL44497a<std::uint32_t> rng2(seq);
        EXPECT_EQUAL(rng, rng2);
    }

    int sims = 0;
    if (auto env_p = std::getenv("TIMING_SIMS")) {
        sims = std::atoi(env_p);
    }

    if (sims) {
        double res1 = 0;
        std::seed_seq seq{1, 2, 3, 4, 5};
        adhoc::canonical<adhoc::WELL44497a<std::uint_fast32_t>> rng(seq);
        {
            auto time1 = std::chrono::high_resolution_clock::now();
            for (std::size_t i = 0; i < sims; i++) {
                res1 += rng();
            }
            auto time2 = std::chrono::high_resolution_clock::now();
            auto time = std::chrono::duration_cast<std::chrono::milliseconds>(
                            time2 - time1)
                            .count();
            std::cout << "new" << std::endl;
            std::cout << time << std::endl;
        }

        double res2 = 0;
        std::array<unsigned int, 1391> seed{
            1731050605, 3533173809, 1635178926, 2178890313, 2894575995,
            3124391466, 3738277652, 3369107531, 3702653374, 1628297818,
            666780699,  2345228673, 1444765150, 1149389068, 100429294,
            2568594623, 289411625,  3009169632, 2681874776, 645788791,
            1659097943, 711518962,  1841958966, 2560321849, 4018621239,
            2622687284, 802932237,  1210692964, 2311676066, 1834607898,
            2397828906, 3188864285, 1606958611, 2377076485, 726329307,
            3116428294, 351634367,  1540237212, 1898188591, 1441434233,
            1650686163, 2808697517, 1526401228, 3841646575, 2782431302,
            1942452942, 117139669,  2078113997, 2480883963, 4088802449,
            490392743,  4289430908, 3436894835, 2913830201, 1175825511,
            1839195753, 3862134170, 3598299376, 3186402298, 2151732238,
            28877909,   413296017,  1357606049, 1608978541, 1629995200,
            3381609484, 3042669884, 1337921583, 2914704111, 2552181723,
            2323978655, 1041962064, 2835367978, 1907670416, 771780247,
            1164482146, 1856324493, 2392241397, 4007302017, 3121506243,
            4039906553, 2102733673, 3466512423, 1150427901, 1772497333,
            2610199515, 652242943,  1925486205, 3812478925, 310917519,
            2566171162, 3159401392, 2076243968, 1822078096, 2896536382,
            3544652115, 112179362,  3209308484, 3204357729, 3368591648,
            2099757215, 357208190,  1804766299, 1869878302, 2878373135,
            1452245531, 1667194216, 1754191207, 2078920249, 2902071523,
            3788421607, 3301228061, 3251588336, 4026070239, 3731964486,
            4282542823, 2078402503, 892369514,  138684051,  328931351,
            3642218556, 1600678893, 3675349392, 317963599,  1877604282,
            4118311557, 1842597043, 352337378,  3468375351, 2760931955,
            480189234,  629876981,  1173949679, 578254660,  3739963018,
            2035871522, 167229310,  643953894,  1735164747, 401884759,
            3209331017, 3415677070, 888337924,  29133819,   1656883727,
            3688563278, 293360492,  680157685,  114074771,  1563931529,
            2702855967, 1484734400, 1835264344, 2146797149, 3434874682,
            1514852568, 2141217107, 1862739884, 3293441871, 2654977193,
            2030141316, 2092350468, 1234772027, 2815260033, 2741021498,
            891238295,  2406706527, 2275350431, 2549398809, 1308590944,
            2448580723, 594612214,  2716131467, 1919044684, 1515026588,
            436874581,  3595885080, 4023517623, 1818382577, 3655907623,
            1100272780, 1606652363, 2884521998, 1261801810, 2819970706,
            672916415,  2659280779, 2855441401, 658845053,  2056499927,
            2971543003, 2263755159, 1541880491, 3946052953, 1377849732,
            96464377,   2957350628, 2433911994, 10934172,   3182824072,
            3850896007, 1477429254, 4210187815, 3236320078, 2594565912,
            3664368622, 1076743846, 1549682761, 2863736847, 4026952129,
            3306132771, 949343561,  992158732,  3950301692, 3726749497,
            1145059237, 3153977086, 2324004831, 2736254518, 143316905,
            2456297275, 703657531,  1029899338, 4034194833, 2665922325,
            1550166282, 339877774,  1595106882, 2249123705, 3018526814,
            3584511845, 175066284,  3886347859, 3126842755, 355910553,
            2981897745, 2500234115, 4199828800, 3380900451, 336359757,
            1251543637, 1813261268, 3296214349, 735252067,  33491477,
            4161273169, 3585689355, 3448553228, 2940867335, 364056496,
            3976481603, 2646244950, 57399154,   3398186312, 4180978129,
            886652864,  1335220808, 1852534947, 512179604,  2535572059,
            433090178,  1011039070, 715769987,  519118256,  2898312120,
            1042484522, 2292905326, 4122001369, 2001231092, 1397572328,
            1148034892, 615343038,  1941853001, 1358632691, 3173755013,
            976730201,  1936505183, 925494331,  614405646,  4284295187,
            4031003984, 351591056,  2969197919, 3791325262, 3144944986,
            1225361728, 4270958353, 200587965,  228700712,  1760164775,
            3807498808, 3494511736, 3675104248, 245455530,  1071736906,
            3648570739, 3929686867, 4252515961, 3855566342, 2091654901,
            4214811928, 3281242435, 4092923409, 3532365568, 493741160,
            3987169351, 2068042993, 373149881,  1296527509, 3765203261,
            1763320357, 1274262224, 2522007410, 4050734416, 436609943,
            1254181100, 853969043,  4213634786, 3670107208, 120507056,
            1188374665, 4041184946, 3619511663, 473263755,  2219791674,
            83356467,   818821687,  9716950,    4036380371, 774944463,
            3223422265, 3944688230, 2648827851, 1018246271, 2224759426,
            139665341,  2494812048, 1852830904, 3372327728, 3747798979,
            2031726202, 3620485171, 2963206506, 165898022,  3652900260,
            683788318,  3894101818, 3270170633, 4099915626, 3984677517,
            1834998777, 4201293649, 3790795338, 1306669527, 2094349242,
            2332461096, 2364288890, 2166159994, 3275501781, 2834807534,
            2817155379, 481538514,  2964633956, 3312255118, 1719485595,
            1855304605, 3688653535, 2940381093, 2426825613, 2877920186,
            2032084767, 2449097251, 2478484043, 2599160229, 173365659,
            3106786917, 3069657812, 1979915587, 3559537715, 2029022784,
            3520221110, 4199674567, 782732081,  1001593534, 2337402409,
            1513051250, 3897453083, 6464566,    885805036,  4225442214,
            83040259,   3277241903, 2040477227, 2265830158, 1828411007,
            4156520285, 4166787307, 804889022,  10097635,   1843409957,
            2532499501, 3097741759, 2801361672, 3863301845, 3373540061,
            2777567712, 2296209365, 2946695560, 3166740451, 2832544670,
            3343184506, 643192333,  2897195878, 3351448625, 1812828972,
            2620688035, 827473512,  347971982,  1838059978, 978980121,
            3479419984, 873137823,  2027606400, 1024332013, 2154663341,
            1276193667, 3931673651, 3212958023, 2115951335, 2533059623,
            224351306,  4070908212, 477632026,  3707326043, 1485986167,
            1183902625, 1762565613, 3115315134, 3833615383, 1157947666,
            1242367785, 2919281723, 858909896,  1148623040, 3946095474,
            2932250872, 330357617,  3044825250, 2409515691, 4191907748,
            33888106,   1484129622, 711581238,  744659032,  2808493405,
            3520333233, 2724901781, 2785663906, 1303452366, 3346399041,
            820006698,  3818753779, 3621270573, 2216110286, 2023119706,
            2908297758, 2802517225, 687541808,  2148320311, 2080527032,
            3937086990, 3098094583, 639598233,  1931166999, 3474774043,
            3646863015, 2538149866, 2446996259, 3021662225, 1500381529,
            665108020,  738270204,  1365160090, 601326290,  2010410659,
            73425845,   153782194,  4171826513, 1738307538, 3702342595,
            606590605,  1280098985, 3509186853, 837399191,  516807761,
            1267900377, 3929374091, 4285549402, 301700974,  4101244867,
            3653596861, 1419992907, 2984423470, 1519100266, 2291146465,
            2063276499, 4157915960, 1091109419, 2826799481, 3894659528,
            1649421470, 3707201747, 2894685956, 1191399064, 103394666,
            3310409067, 1274985472, 1544298579, 2726097668, 3297760061,
            2557347777, 1607880295, 658808017,  3988112833, 1323901034,
            2601227085, 2658707606, 3897300128, 1579155024, 205437127,
            4063810221, 2903506417, 709132808,  1026867858, 3728983865,
            1136983238, 3969093158, 1680673825, 4029913293, 3417197982,
            1717915006, 1807340439, 2117645244, 59802239,   1016805589,
            924163546,  3518435984, 1655922864, 503941626,  3955325851,
            3708367519, 2729691246, 2545960598, 990809785,  3454260478,
            20073122,   3360922308, 1776143589, 3539790077, 910414459,
            1814185886, 756476100,  1489218569, 3481236143, 2797126229,
            168205308,  855432835,  3178608932, 1825769774, 3848000526,
            3308802328, 990737625,  1146820202, 4191111851, 2524508758,
            3461885340, 1522115354, 3132721165, 4182449630, 3440909611,
            2277582248, 1572909818, 1981795876, 2227647923, 4162937141,
            400556563,  1546747633, 11649844,   3974538430, 767980218,
            1345533203, 3425997252, 3651640217, 2827226855, 349515727,
            519373460,  3691192798, 2271941827, 1859722964, 2266766183,
            3160925801, 2728385808, 1289449354, 3690190987, 1918817694,
            3970783030, 1829735325, 874410997,  574319284,  2578487298,
            3978328931, 2562548953, 3183798512, 2744474090, 3658874444,
            1039583615, 3096361247, 2516782997, 2137805049, 3541714346,
            1533646709, 331739600,  625115984,  1010808373, 545406966,
            1632471883, 2648914368, 4049401833, 388888363,  3126845631,
            467385117,  4277213151, 976509976,  88287035,   1550468288,
            62151676,   3094144906, 388302200,  3908337253, 3446911924,
            1703563951, 73180891,   3494548891, 1885368735, 2694374689,
            3985739638, 1711850222, 3164108617, 141614781,  737356141,
            520096749,  640423711,  127633626,  1888146066, 3362748542,
            1464894940, 3335881831, 1132246015, 314631318,  245840387,
            3928123105, 2971135127, 3039966382, 3047458732, 2847412901,
            51003687,   3170955783, 2360847635, 2908934274, 4012575964,
            610667908,  3918402694, 2280771127, 1334295295, 1068884898,
            2720982934, 2819633405, 2243975929, 2312467919, 1462347059,
            2230251498, 3617285451, 724197898,  2829644344, 3932199992,
            2498960609, 3286802043, 1842329498, 2361278281, 2880835780,
            246723635,  2349616261, 1841707112, 205099906,  1123038746,
            2011378717, 236136376,  4145298501, 1359090793, 1382175517,
            39610804,   3574616366, 1999323391, 3628551683, 626621031,
            1077833738, 1323879525, 4133776495, 719031586,  2643541321,
            1950556568, 1233168260, 1214614559, 2671173263, 1094712197,
            1806488250, 3325029762, 1131961064, 1663280603, 4225707340,
            17829946,   464286316,  3458582106, 1161608692, 370046946,
            3425438918, 3712859031, 2918745602, 2056560552, 628553610,
            2912904703, 3941995123, 1249479874, 1129678941, 590697052,
            1461491196, 2570323048, 2791105018, 1379253644, 1982663410,
            2577709279, 600197373,  1450203840, 3314259117, 3733968896,
            2723517042, 74886949,   4150538180, 436302489,  955644071,
            1889841416, 3142862133, 2851481530, 537641652,  2813321609,
            3165581553, 1643663883, 325184379,  1523166052, 545555096,
            3246944749, 1547726523, 924436153,  2906124042, 2106914666,
            1352356106, 3624202634, 3360038381, 1661440938, 1370343497,
            126334946,  1131823790, 433230716,  668578032,  3052783493,
            1718589157, 2816670088, 428814565,  307729354,  196586640,
            2427266945, 4033340584, 223911319,  2231529261, 3854447247,
            3776984113, 2107010930, 3119945886, 4127354097, 466662147,
            3772866929, 1887339186, 3363276267, 3602013744, 3821834533,
            2631123631, 815347047,  4278709544, 2136105414, 2073596877,
            1252553709, 2651037055, 412754634,  858899607,  3064824935,
            3976941041, 3676596037, 172207972,  2556645904, 258542708,
            2693846829, 2461765462, 131540626,  3447279930, 2691766852,
            1328242745, 3741621865, 908567446,  3522299295, 1914321652,
            3747826960, 526826808,  886312319,  3869882345, 700941717,
            3372675439, 3840394179, 889023457,  2241523587, 3058376002,
            3010672500, 1836014149, 1827412815, 3882750333, 3261326654,
            2599770945, 2761051218, 1008293649, 578700177,  2534139040,
            2605292531, 3835879557, 1004709923, 2766918477, 1610532523,
            3093707446, 1355842433, 2420622577, 2455466084, 4221009001,
            96615204,   4209732202, 3822728645, 3673485319, 3291291484,
            2704387489, 291841017,  380784576,  3390981104, 890231241,
            611696493,  2276838543, 1247807807, 2887131054, 2554754217,
            3515364758, 1854613545, 3703235359, 4116667133, 1457415125,
            3750696318, 3285098468, 2195348028, 620661078,  1257358217,
            3878953955, 1437519897, 2511695719, 925894885,  2240488057,
            3497277778, 2581660698, 1791169846, 2868077612, 204142581,
            3850141556, 1562271871, 3811473061, 2001242682, 262483279,
            3509367425, 2272850836, 2165289131, 3627548970, 2532790825,
            2937752494, 2605168792, 3177525963, 810034992,  2551645606,
            1777692024, 3982072553, 526574626,  2923736577, 1562941026,
            2314888728, 176736731,  198036801,  338079002,  1700632956,
            105064839,  3963816319, 4028125537, 2286791428, 3554206084,
            3300431510, 3503440627, 2381845342, 267705743,  3320914568,
            226870980,  3778902457, 3572342174, 3203502753, 47966268,
            3146857457, 2870001040, 40938947,   606095456,  3849741750,
            1053231247, 2370065996, 1252172642, 4188253003, 1428817224,
            16011527,   1686516951, 3734365480, 1679391871, 1154762292,
            819862330,  3511164848, 1615093388, 4075793880, 1940491668,
            626460988,  1923269291, 2007544720, 1762092751, 2824483325,
            1174319061, 398165856,  2003426309, 4269945868, 3344040475,
            4120804588, 463779145,  2886858127, 3577865564, 2357788612,
            3389526973, 846397747,  1328519576, 466342888,  402021057,
            383678083,  3002100023, 3339507421, 3505011838, 938692190,
            290018335,  3257557685, 221922104,  449669419,  2856866896,
            3765433753, 1104614262, 2259218911, 4090725642, 658386410,
            209009655,  3293734898, 1536068629, 1329837054, 1158079098,
            4249966048, 2937606505, 3995035024, 2696700679, 608986570,
            1024025641, 2239770416, 3671976168, 4138774155, 2662214793,
            3389144019, 3168682346, 1070242843, 3466254278, 3854487660,
            2664251584, 2198131154, 770224428,  2760457311, 971498061,
            2462816815, 1800004980, 1531928323, 2225818289, 3679538125,
            695507394,  705570707,  1571581619, 2595599304, 3095965968,
            2085679745, 4140517017, 2538667203, 2316599945, 3248539894,
            4242296285, 3052486163, 2224053936, 4175138690, 28210374,
            1088230460, 944322624,  2954227488, 2891998177, 4100375057,
            4085659774, 1591952336, 432950516,  41489764,   2301489961,
            4162666276, 4097117834, 3024500023, 1662724001, 1072121329,
            1278194945, 3681739254, 491732645,  6082277,    3941666594,
            104996493,  985584640,  2055008374, 3960816270, 1628710365,
            1833303188, 419861246,  3921220346, 260955112,  280546629,
            2608056859, 465412706,  193218168,  3519807571, 811642233,
            2252632457, 1819761086, 954429480,  2732888825, 1968606650,
            923871842,  875349135,  2842665788, 490610615,  2179039102,
            3091434145, 3179071477, 2325026349, 72059252,   1682398986,
            3530597970, 1557757115, 3341944497, 843004053,  1800539584,
            1232379123, 3098869445, 559944126,  4059005764, 2299324557,
            3740439360, 2503037305, 3859084968, 3870501022, 851717021,
            3646325233, 1086540218, 2294744688, 1033294604, 2214811304,
            2840436419, 1351488859, 1687208199, 3293726795, 2543344583,
            2589773084, 4232558202, 1522738805, 2256665786, 2531628051,
            2469371246, 4132648041, 2439739305, 4035369286, 2284042069,
            632735895,  1363893988, 1741452595, 1882337153, 4034375041,
            1494765608, 1497310872, 1291909620, 246036313,  2394593387,
            3576057356, 4069782806, 3828702815, 268965990,  972347385,
            4212244234, 4072968445, 948829748,  2371199510, 2804481785,
            341620108,  1535043422, 481485028,  477507745,  12521344,
            103263493,  1515317440, 4083852022, 131304777,  4205035643,
            3805725018, 2252085277, 3087814975, 2353692310, 3732871266,
            1315057734, 2162603924, 1335352985, 2604044130, 666359265,
            839985493,  30651119,   3156229293, 1961257038, 1936492875,
            3294767283, 2558652851, 314804118,  2173716335, 894156702,
            4102595915, 1586728487, 3572628730, 4000034795, 716243366,
            1925420548, 123099354,  3352258600, 3718315900, 3070356156,
            3919336297, 1145315062, 2768044787, 3353515859, 3022036772,
            3693467250, 1859299767, 1363661263, 282373362,  2124318480,
            1867785181, 203852386,  3121286660, 1399414761, 4141193342,
            3352053583, 1964850632, 480380761,  1286884969, 3236275209,
            20259493,   3451908014, 1166918904, 1965646295, 331088365,
            1049336021, 4247648533, 552564192,  4235418099, 2296009359,
            1267244504, 2722422447, 781396106,  241197009,  31857393,
            187360296,  996203042,  1533312332, 3576796463, 2068167301,
            4149558649, 65711463,   3760074086, 3762776123, 579311915,
            1163837632, 1609869394, 356934688,  3921049490, 171411809,
            3156798046, 2501652473, 1095983046, 2747063130, 1206941772,
            1708985409, 1214876344, 4144121679, 3922273166, 2736108692,
            1262306945, 2484562470, 2600371469, 3774190312, 759508372,
            2994490439, 639238028,  1110779513, 876584316,  1100501194,
            2336181478, 1137855109, 481323070,  4192258192, 85563546,
            358994098,  1257850979, 4018247022, 1581639646, 321267112,
            2867534450, 1995369056, 1827529786, 3989877709, 2639147594,
            601575257,  2223760073, 2109729244, 2551158874, 2019884713,
            200814645,  3647964971, 3290956090, 2998636491, 3231382093,
            3191193057, 511425109,  3913765375, 491477877,  3872205971,
            1837485159, 134498360,  619537341,  2102169211, 1636027548,
            4084163305, 737815933,  1479260580, 4210865245, 2262708006,
            3832616451, 804262256,  1955130840, 2395432302, 1077250629,
            2383891216, 1054134631, 2423900707, 4053042540, 3782541914,
            1710650393, 28772531,   2166912393, 3073855355, 1661638414,
            3875401758, 2007862591, 2306576373, 283340323,  3991168548,
            1773185769, 3015635435, 982464332,  2669776696, 1973057142,
            3001585776, 2872395063, 2601381910, 879600877,  3012461390,
            3505020607, 1951377703, 367570834,  1509185444, 3014177426,
            4005834693, 1799727976, 4070411616, 3281128759, 2601940523,
            2864340761, 1125662200, 2036484629, 856203249,  3409940348,
            657548757,  1165168535, 3209444860, 1420138342, 3593175929,
            1055828277, 2993422566, 1912604990, 2799410640, 592273282,
            3845641770, 2912870290, 1966890435, 494688786,  38073675,
            2045628276, 73649656,   2246649306, 1179253094, 594616890,
            974137016,  3042114544, 2890804026, 1476657938, 4212443894,
            3889318725, 2201731973, 3052884893, 4113840051, 2833203677,
            4273330908, 3198003002, 2016340735, 3006538210, 3661123370,
            834347324,  1992753753, 2336812400, 625022817,  2667514979,
            1633229887, 1642928568, 3554621240, 1889992271, 4262422528,
            1581249398, 3307304306, 644239551,  3455371545, 449049486,
            3280367654, 784472292,  480028933,  3192092233, 182461595,
            3629854338, 3124808952, 2439110779, 3860128681, 3279138608,
            2925071280, 4285033060, 2760943171, 3755352358, 2359004066,
            2655672152};
        InitWELLRNG44497a(seed.data());
        {
            auto time1 = std::chrono::high_resolution_clock::now();
            for (std::size_t i = 0; i < sims; i++) {
                res2 += WELLRNG44497a();
            }
            auto time2 = std::chrono::high_resolution_clock::now();
            auto time = std::chrono::duration_cast<std::chrono::milliseconds>(
                            time2 - time1)
                            .count();
            std::cout << "old" << std::endl;
            std::cout << time << std::endl;
        }
        EXPECT_EQUAL(res1, res2);

        double res1b = 0;
        {
            auto time1 = std::chrono::high_resolution_clock::now();
            for (std::size_t i = 0; i < sims; i++) {
                res1b += rng.operator()<false>();
            }
            auto time2 = std::chrono::high_resolution_clock::now();
            auto time = std::chrono::duration_cast<std::chrono::milliseconds>(
                            time2 - time1)
                            .count();
            std::cout << "new back" << std::endl;
            std::cout << time << std::endl;
        }
        EXPECT_NEAR_REL(res1, res1b, 1e-5);
    }

    TEST_END;
}
